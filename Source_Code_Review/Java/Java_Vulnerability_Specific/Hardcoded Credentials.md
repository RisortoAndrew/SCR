## **1. Introduction to Hardcoded Credentials**

**Hardcoded Credentials** refer to embedding authentication data such as usernames, passwords, API keys, tokens, or encryption keys directly within the source code. This practice is a significant security vulnerability as it can lead to unauthorized access, data breaches, and compromise of the entire system if the code is exposed or leaked.

Hardcoded credentials are particularly dangerous because:

- **Ease of Discovery**: Attackers can decompile applications or access source code repositories to extract credentials.
- **Static Credentials**: Hardcoded credentials are often not rotated, making them valid for extended periods.
- **Propagation of Credentials**: Once exposed, hardcoded credentials can be used to access multiple systems if reused.
- **Compliance Violations**: Storing credentials in code may violate regulations like PCI DSS, HIPAA, or GDPR.

Identifying and eliminating hardcoded credentials is crucial for securing applications and protecting sensitive data.

---

<a name="vulnerable-patterns"></a>
## **2. Common Vulnerable Patterns in Java**

Vulnerable patterns in Java applications that involve hardcoded credentials include:

- **Embedding Plain Text Credentials**: Directly assigning usernames, passwords, API keys, or tokens to variables.
- **Hardcoded Database Connection Strings**: Including database URLs with credentials in the code.
- **Storing Credentials in Configuration Files Checked into Source Control**: Including sensitive information in properties or XML files.
- **Including Credentials in Comments or Debugging Statements**: Leaving credentials in comments or logs for troubleshooting purposes.
- **Using Credentials in Scripts or Build Files**: Hardcoding credentials in scripts like Ant, Maven, or Gradle build files.
- **Embedding Encryption Keys or Salts**: Hardcoding cryptographic keys, salts, or initialization vectors (IVs) in code.
- **Storing Credentials in Version Control History**: Committing credentials to version control systems where they remain in history even after removal.

---

<a name="regex-patterns"></a>
## **3. Regex Patterns for Detection**

Below are regex patterns designed to identify potential hardcoded credentials in Java code. Since you have no access to automated tools, you can use these patterns in your IDE's global search functionality to manually search the codebase.

### **3.1. Hardcoded Username and Password Variables**

#### Kitchen Sink
```regex
(pass\b|pwd\b|passwd\b|password\b|secret\b|scrt\b|scr\b|sct\b|cred\b|creds\b|credential\b|credentials\b|key\b|api_key\b|secret_key\b|client_key\b|token\b|tok\b|tkn\b|enc\b|encryption\b|cipher\b|crypt\b)
```

- **Password-related:**
    
    - `password\s*[:=]\s*['"].+['"]`
    - `passwd\s*[:=]\s*['"].+['"]`
    - `pwd\s*[:=]\s*['"].+['"]`
    - `pass\s*[:=]\s*['"].+['"]`
- **Token-related:**
    
    - `token\s*[:=]\s*['"].+['"]`
    - `auth_token\s*[:=]\s*['"].+['"]`
    - `access_token\s*[:=]\s*['"].+['"]`
    - `refresh_token\s*[:=]\s*['"].+['"]`
    - `jwt\s*[:=]\s*['"].+['"]`
- **API Keys / Secrets / Other Sensitive Keys:**
    
    - `api_key\s*[:=]\s*['"].+['"]`
    - `secret_key\s*[:=]\s*['"].+['"]`
    - `key\s*[:=]\s*['"].+['"]`
    - `client_secret\s*[:=]\s*['"].+['"]`
    - `app_secret\s*[:=]\s*['"].+['"]`
- **Database Credentials:**
    
    - `db_password\s*[:=]\s*['"].+['"]`
    - `database_password\s*[:=]\s*['"].+['"]`
    - `mysql_password\s*[:=]\s*['"].+['"]`
- **Usernames / ID-related:**
    
    - `username\s*[:=]\s*['"].+['"]`
    - `user_id\s*[:=]\s*['"].+['"]`
- **OAuth Tokens:**
    
    - `client_id\s*[:=]\s*['"].+['"]`
    - `client_secret\s*[:=]\s*['"].+['"]`
- **JWT Tokens:**
    
    - `[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+`

**Pattern**:

```regex
(String|char\[\])\s+(username|user|userid|password|passwd|pwd|secret|token|apiKey|api_key|accessKey|access_key|clientId|client_id|clientSecret|client_secret)\s*=\s*["'][^"']{4,}["']
```

**Explanation**:

- Detects variables of type `String` or `char[]` assigned to hardcoded strings.
- Variable names include common credential identifiers like `username`, `password`, `apiKey`, etc.
- Excludes empty strings and short strings (less than 4 characters) to reduce false positives.

### **3.2. Hardcoded Credentials in Properties or HashMaps**

**Pattern**:

```regex
(setProperty|put)\s*\(\s*["'](username|user|userid|password|passwd|pwd|secret|token|apiKey|api_key|accessKey|access_key|clientId|client_id|clientSecret|client_secret)["']\s*,\s*["'][^"']{4,}["']
```

**Explanation**:

- Finds calls to `setProperty` or `put` methods where credentials are assigned.
- Targets configuration properties or collections that may store credentials.

### **3.3. Hardcoded Database Connection Strings**

**Pattern**:

```regex
DriverManager\.getConnection\s*\(\s*["'][^"']*[:@][^"']*["']
```

**Explanation**:

- Detects `DriverManager.getConnection()` calls with connection strings that may include credentials.
- Looks for `:` or `@` symbols within the string, which are common in connection URLs containing usernames and passwords.

### **3.4. Hardcoded Credentials in Annotations**

**Pattern**:

```regex
@(?:Value|Autowired)\s*\(\s*["'][^"']*(password|passwd|pwd|secret|token|apiKey|api_key|accessKey|access_key)["']\s*\)
```

**Explanation**:

- Identifies Spring annotations where credentials may be injected via hardcoded values.
- Checks for annotations like `@Value` or `@Autowired` with credential-related keys.

### **3.5. Hardcoded Encryption Keys or Salts**

**Pattern**:

```regex
\b\w*?(key|secret|salt|password|passphrase)\w*\s*=\s*(["'][^"']*["']|\{[^}]*\}|new\s+\w+\s*\(.*\))
```

**Explanation**:

- Detects hardcoded byte arrays that may represent keys or IVs.
- Captures strings that look like Base64-encoded keys or salts.

### **3.6. Credentials in Comments**

**Pattern**:

```regex
//.*(username|password|passwd|pwd|secret|token|apiKey|api_key|accessKey|access_key).*
```

**Explanation**:

- Finds comments that may contain credentials.
- Useful for detecting credentials left in code comments.

### **3.7. Credentials in Logging Statements**

**Pattern**:

```regex
(log\.|LOGGER\.|Logger\.)(debug|info|warn|error|trace|fatal)\s*\(.*(".*(password|passwd|pwd|secret|token|apiKey|api_key|accessKey|access_key).*"|\w+)\s*\)
```

**Explanation**:

- Detects logging statements that include variables or messages containing credential keywords.
- Ensures that credentials are not inadvertently logged.

### **3.8. Credentials in Configuration Files**

Since configuration files may not be `.java` files, manually inspect files like `application.properties`, `application.yml`, or XML configuration files for hardcoded credentials.

**Pattern Example for Properties Files**:

```properties
^(username|user|userid|password|passwd|pwd|secret|token|apiKey|api_key|accessKey|access_key)\s*=\s*.+$
```

**Explanation**:

- Matches key-value pairs where the key is a credential-related identifier and the value is non-empty.

---

<a name="examples"></a>
## **4. Detailed Examples and Explanations**

### **4.1. Vulnerable Code Example: Hardcoded Password Variable**

```java
public class DatabaseConnector {
    private static final String DB_USERNAME = "admin";
    private static final String DB_PASSWORD = "P@ssw0rd!";
    
    public Connection getConnection() throws SQLException {
        return DriverManager.getConnection(DB_URL, DB_USERNAME, DB_PASSWORD);
    }
}
```

**Why It's Vulnerable**:

- The username and password are hardcoded as constants in the code.
- If the code is exposed, the credentials can be extracted.
- Credentials are not rotated and remain static.

**Regex Match Explanation**:

- The regex matches `String DB_PASSWORD = "P@ssw0rd!";` due to the variable name `DB_PASSWORD` and assignment of a non-empty string.

### **4.2. Vulnerable Code Example: Hardcoded API Key in Properties**

```java
Properties props = new Properties();
props.setProperty("apiKey", "ABCD-1234-EFGH-5678");
props.setProperty("apiSecret", "secretkeyvalue");
```

**Why It's Vulnerable**:

- The API key and secret are hardcoded into the properties object.
- Exposes credentials that may grant access to external services.

**Regex Match Explanation**:

- The regex matches `props.setProperty("apiKey", "ABCD-1234-EFGH-5678");`.

### **4.3. Vulnerable Code Example: Hardcoded Credentials in Connection String**

```java
String dbUrl = "jdbc:mysql://localhost:3306/mydb?user=root&password=admin123";
Connection conn = DriverManager.getConnection(dbUrl);
```

**Why It's Vulnerable**:

- The database URL contains the username and password.
- Credentials are embedded in the connection string.

**Regex Match Explanation**:

- The regex detects `DriverManager.getConnection("jdbc:mysql://...")` with a connection string that includes `user=` and `password=`.

### **4.4. Vulnerable Code Example: Hardcoded Encryption Key**

```java
byte[] encryptionKey = { 0x74, 0x68, 0x69, 0x73, 0x49, 0x73, 0x41, 0x4B, 0x65, 0x79 };
SecretKeySpec keySpec = new SecretKeySpec(encryptionKey, "AES");
```

**Why It's Vulnerable**:

- The encryption key is hardcoded in the code.
- Exposure of the code leads to compromise of the encryption key.

**Regex Match Explanation**:

- The regex captures `byte[] encryptionKey = { ... }` where the byte array may represent a key.

### **4.5. Vulnerable Code Example: Credentials in Comments**

```java
// TODO: Remove before production
// String tempPassword = "temporary123";
```

**Why It's Vulnerable**:

- Credentials are left in code comments.
- Even though commented out, they may be accessible through code repositories or decompilation.

**Regex Match Explanation**:

- The regex finds comments containing `password`.

### **4.6. Vulnerable Code Example: Credentials in Logging Statements**

```java
String token = "Bearer xyz123";
log.debug("Authentication token: " + token);
```

**Why It's Vulnerable**:

- Logs the authentication token.
- If logs are accessed by unauthorized users, tokens can be compromised.

**Regex Match Explanation**:

- The regex detects `log.debug(...)` with a variable `token` that may contain sensitive data.

---

<a name="interpreting-findings"></a>
## **5. Interpreting and Validating Findings**

- **Review Variable Names**: Pay attention to variable names that suggest they hold credentials (e.g., `password`, `apiKey`, `secret`).
- **Assess the Context**: Determine if the hardcoded values are actual credentials or placeholders/test data.
- **Check for Placeholders**: Sometimes, credentials like `"your_password_here"` are placeholders and not actual credentials.
- **Consider the Environment**: Identify if the code is intended for production or test environments.
- **Look for Credential Rotation**: Check if there are mechanisms in place to rotate or invalidate hardcoded credentials.
- **Beware of False Positives**: Not all matches indicate real credentials; manual verification is necessary.

**Example**:

- A variable `String password = "changeMe";` may be a placeholder but should still be addressed to prevent misuse.
- Comments with credentials should be removed, even if they are outdated or no longer valid.

---

<a name="prevention"></a>
## **6. Best Practices for Prevention**

### **6.1. Externalize Credentials**

- **Use Configuration Files**: Store credentials in configuration files (`.properties`, `.yaml`, `.json`) that are not checked into source control.
- **Environment Variables**: Use environment variables to pass credentials to the application.
- **Example**:

  ```java
  // Using environment variables
  String dbUsername = System.getenv("DB_USERNAME");
  String dbPassword = System.getenv("DB_PASSWORD");
  ```

### **6.2. Secure Storage of Credentials**

- **Secret Management Systems**: Use tools like HashiCorp Vault, AWS Secrets Manager, or Azure Key Vault to securely store and retrieve credentials.
- **Encrypted Configuration**: Encrypt configuration files that contain sensitive information.

### **6.3. Avoid Committing Credentials to Version Control**

- **Git Ignore**: Use `.gitignore` to exclude files containing credentials from being committed.
- **Credential Scanning Tools**: Use tools that scan for secrets before committing code.
- **Git Hooks**: Implement pre-commit hooks to prevent accidental commits of sensitive data.

### **6.4. Use Placeholder Values in Code**

- **Placeholders**: Use placeholder values that clearly indicate they need to be replaced.
- **Example**:

  ```java
  String dbUsername = "your_username_here";
  String dbPassword = "your_password_here";
  ```

### **6.5. Implement Runtime Credential Injection**

- **Dependency Injection**: Inject credentials at runtime using dependency injection frameworks like Spring.
- **Example**:

  ```java
  @Value("${db.username}")
  private String dbUsername;

  @Value("${db.password}")
  private String dbPassword;
  ```

- Ensure that the properties files are external and secured.

### **6.6. Secure Key Management for Cryptographic Keys**

- **Generate Keys Securely**: Generate keys at runtime using secure random number generators.
- **Example**:

  ```java
  KeyGenerator keyGen = KeyGenerator.getInstance("AES");
  keyGen.init(256);
  SecretKey secretKey = keyGen.generateKey();
  ```

- **Key Storage**: Store keys in secure keystores like Java KeyStore (JKS) or PKCS#12.