**1.1 Searching for `password`/`secret`/`token` in PHP array assignments**

```regex
['"](password|secret|token|apikey|credential)['"]\s*=>\s*['"][^'"]+['"]
```

**Explanation:**  
Looks for associative array entries with keys like “password,” “secret,” etc., assigned string literals.

**Example:**

```php
$config = [
    'database' => [
        'password' => 'MyDBSecret123!'
    ],
    'api' => [
        'token' => 'abcdef123456'
    ]
];
```

**Security Impact:**  
Hardcoding credentials in arrays makes them easy to leak if the code is exposed.

---

**1.2 PHP variables named `password`/`secret`/`token` assigned directly**

```regex
\$(password|secret|token|apikey|credential)\s*=\s*['"][^'"]+['"]
```

**Explanation:**  
Finds `$password = 'whatever';` or `$secret = '...'` assignments.

**Example:**

```php
$apiKey = 'abc123XYZ789';
$password = 'SuperSecret!';
```

**Security Impact:**  
Compromise of source code or logs reveals these credentials.

---

**1.3 `.env` file style credentials**

```regex
^(PASSWORD|SECRET|TOKEN|APIKEY|CREDENTIAL|DB_PASS|DB_PASSWORD)\s*=\s*.+$
```

**Explanation:**  
Targets typical `.env` entries. Adjust to match your environment variable naming conventions.

**Example:**

```
DB_PASSWORD=MyEnvPass123
APIKEY=xyz987secret
```

**Security Impact:**  
Leaked `.env` files can expose entire production infrastructure credentials.

---

**1.4 Database connection strings in PHP**

```regex
['"]mysql:host=[^;]+;dbname=[^;]+;[^'"]*['"]
```

**Explanation:**  
Detects literal DSN connection strings in code (PDO style).

**Example:**

```php
$dsn = "mysql:host=127.0.0.1;dbname=production;port=3306";
$username = "root";
$password = "RootPass!";
```

**Security Impact:**  
Exposing DB connection info can allow direct DB compromise.

---

**1.5 `$pass` or `$pwd` variable assignments**

```regex
\$(?:pass|pwd)[A-Za-z0-9_]*\s*=\s*['"][^'"]+['"]
```

**Explanation:**  
Flags variables containing “pass” or “pwd” assigned to string literals.

**Example:**

```php
$pwdAdmin = 'adm1nPa$$';
```

**Security Impact:**  
Again, storing passwords in plain text risks immediate credential compromise.

---

**1.6 JSON‐style hardcoded secrets in PHP strings**

```regex
['"]\{[^}]*"(apiKey|secret|token)"\s*:\s*"[^"]+"[^}]*\}['"]
```

**Explanation:**  
Catches JSON strings embedded in PHP code that have sensitive fields like “apiKey” or “token.”

**Example:**

```php
$authPayload = '{"apiKey": "XYZabc123", "secret": "secretValue"}';
```

**Security Impact:**  
Attackers can parse these JSON objects to obtain secrets.

---

**1.7 `$config` array with known secret fields**

```regex
(\$config|\$settings)\s*=\s*\[[^\]]*(password|secret|token|apikey|credential)[^\]]*\]
```

**Explanation:**  
Looks for `$config = [ ... password|secret|token|apikey ... ];` blocks.

**Example:**

```php
$config = [
  'db_user' => 'admin',
  'db_pass' => 'hardcoded123!'
];
```

**Security Impact:**  
Configuration arrays often end up in repos, exposing credentials.

---

**1.8 Commented‐out credentials**

```regex
//.*(password|secret|token|apikey|credential)=?.*
```

**Explanation:**  
Detects single‐line comments that mention a credential. Great for catching left‐behind secrets.

**Example:**

```php
// $password = "Testing123!"; // TODO: remove before production
```

**Security Impact:**  
Even commented credentials can be recovered from version history or by malicious insiders.

---

**1.9 PHP constants containing secrets**

```regex
define\s*\(\s*['"](PASSWORD|SECRET|TOKEN|APIKEY|CREDENTIAL)[A-Za-z0-9_]*['"]\s*,\s*['"][^'"]+['"]\s*\)
```

**Explanation:**  
Searches for `define('PASSWORD_XXX', 'something')` or similar.

**Example:**

```php
define('SECRET_TOKEN', 'secr3tVal');
```

**Security Impact:**  
Constants are globally accessible and easily leaked if your code is exposed.

---

**1.10 `$GLOBALS` or `$_SERVER` secrets**

```regex
\$GLOBALS\['(password|secret|token|apikey|credential)'\]\s*=\s*['"][^'"]+['"]
```

**Explanation:**  
Flags usage of `$GLOBALS` array for storing secrets. Similarly for `$_SERVER`.

**Example:**

```php
$GLOBALS['password'] = 'globalPass123';
```

**Security Impact:**  
Global scope storage can be used anywhere, often inadvertently exposing secrets.

---

# 2. SQL Injection / Dynamic SQL Vulnerabilities

Building SQL strings naively in PHP (especially via `mysqli_query()`, `PDO->query()`, etc.) invites injection if user input is not parameterized. These regexes help identify string concatenations and manual SQL building.

---

**2.1 Concatenation in `mysqli_query`**

```regex
mysqli_query\s*\([^,]+,\s*["'].*(SELECT|INSERT|UPDATE|DELETE).*["']\s*\.\s*\$
```

**Explanation:**  
Searches for `mysqli_query($conn, "SELECT ...".$variable)` patterns.

**Example:**

```php
mysqli_query($conn, "SELECT * FROM users WHERE id = " . $_GET['user_id']);
```

**Security Impact:**  
Unescaped user input in the query leads to injection.

---

**2.2 Concatenation in `PDO->query()` calls**

```regex
->query\s*\(\s*["'].*(SELECT|INSERT|UPDATE|DELETE).*["']\s*\.\s*\$
```

**Explanation:**  
Flags `PDO->query("SELECT ..." . $var)` usage without prepared statements.

**Example:**

```php
$db->query("INSERT INTO items (name) VALUES ('" . $_POST['item_name'] . "')");
```

**Security Impact:**  
Attackers can craft values to break or manipulate the query.

---

**2.3 `$sql = "SELECT ... " . $_POST[...]`**

```regex
\$sql\s*=\s*["'].*(SELECT|INSERT|UPDATE|DELETE).*["']\s*\.\s*\$_(GET|POST|REQUEST)\[
```

**Explanation:**  
Catches direct assignment of `$sql` with partial user input from `$_GET`, `$_POST`, or `$_REQUEST`.

**Example:**

```php
$sql = "DELETE FROM products WHERE id=" . $_POST['pid'];
```

**Security Impact:**  
Highly prone to injection if not sanitized or parameterized.

---

**2.4 `$where = "WHERE ..." . $variable;`**

```regex
["']WHERE\s+[^"']*["']\s*\.\s*\$
```

**Explanation:**  
Looks for string “WHERE ...” concatenated with a variable, typical injection scenario.

**Example:**

```php
$whereClause = "WHERE username='" . $_POST['user'] . "'";
```

**Security Impact:**  
Malicious input might close or alter the query condition.

---

**2.5 Using `sprintf` or `printf` to build queries**

```regex
(sprintf|printf)\s*\(\s*["'].*(SELECT|INSERT|UPDATE|DELETE).*["'].*\$_(GET|POST|REQUEST)
```

**Explanation:**  
`sprintf("SELECT * FROM table WHERE col='%s'", $_GET['val'])` can also be exploited if not escaped.

**Example:**

```php
$query = sprintf("SELECT * FROM users WHERE id='%s'", $_GET['uid']);
```

**Security Impact:**  
Still vulnerable if you don’t properly escape or parameterize the input.

---

**2.6 `$query .=` (incremental query building)**

```regex
\\$query\\s*\\.\\=\\s*["'](SELECT|INSERT|UPDATE|DELETE).*["']\\s*\\.\\s*\\$
```

**Explanation:**  
Flags incremental query building with `$query .= " ... " . $var;`.

**Example:**

```php
$query = "SELECT * FROM orders";
$query .= " WHERE id=" . $_GET['order_id'];
```

**Security Impact:**  
Repeated concatenation patterns are easy to miss or forget to sanitize.

---

**2.7 `mysql_query()` usage (legacy)**

```regex
mysql_query\s*\(\s*["'].*(SELECT|INSERT|UPDATE|DELETE).*["'].*\)
```

**Explanation:**  
`mysql_*` functions are deprecated but might still exist. Look for direct query strings.

**Example:**

```php
mysql_query("UPDATE users SET role='admin' WHERE id=" . $_GET['uid']);
```

**Security Impact:**  
Legacy functions and direct concatenation can be easily abused.

---

**2.8 Double concatenation with `$_GET` or `$_POST`**

```regex
["'].*["']\s*\.\s*\$_(GET|POST|REQUEST)\[[^\]]+\]\s*\.\s*["'].*["']
```

**Explanation:**  
Looks for strings like `"SELECT '" . $_GET['x'] . "' FROM table"` indicating multiple concatenation segments.

**Example:**

```php
$sql = "SELECT '" . $_GET['val'] . "' AS inputVal FROM dual";
```

**Security Impact:**  
Multiple concatenation points = more injection vectors.

---

**2.9 `$pdo->exec(...)` with concatenation**

```regex
->exec\s*\(\s*["'].*(CREATE|DROP|ALTER).*\.\s*\$
```

**Explanation:**  
Catches DDL statements (CREATE/DROP/ALTER) built dynamically with `$pdo->exec()`.

**Example:**

```php
$db->exec("DROP TABLE " . $_GET['table_name']);
```

**Security Impact:**  
Attackers might drop or alter arbitrary tables if the input is not restricted.

---

**2.10 `LIKE` clause injection**

```regex
["']\s*LIKE\s*['"]\s*\.\s*\$_(GET|POST|REQUEST)
```

**Explanation:**  
Focuses on `LIKE` statements with user input appended (common for search features).

**Example:**

```php
$sql = "SELECT * FROM products WHERE name LIKE '%" . $_POST['searchTerm'] . "%'";
```

**Security Impact:**  
Malicious `%` or `_` expansions can lead to wildcard queries or injection attempts.

---

# 3. OS Command Injection / Shell Injection

PHP allows shell commands via functions like `exec`, `shell_exec`, `passthru`, `system`, etc. If user input is passed unsanitized, attackers can run arbitrary commands.

---

**3.1 `exec()` with string concatenation**

```regex
exec\s*\(\s*["'][^"']*["']\s*\.\s*\$
```

**Explanation:**  
Identifies `exec("cmd " . $var)` calls.

**Example:**

```php
exec("ls -la " . $_GET['path']);
```

**Security Impact:**  
Enables attackers to append malicious arguments or chain extra commands.

---

**3.2 `shell_exec()` with user input**

```regex
shell_exec\s*\(\s*["'][^"']*["']\s*\.\s*\$
```

**Explanation:**  
Flags usage of `shell_exec("something " . $untrusted)`.

**Example:**

```php
$output = shell_exec("cat " . $_POST['filename']);
```

**Security Impact:**  
Attackers can read or manipulate the file system.

---

**3.3 `system()` with concatenation**

```regex
system\s*\(\s*["'][^"']*["']\s*\.\s*\$
```

**Explanation:**  
Searches for `system("rm " . $var)`, etc.

**Example:**

```php
system("rm /tmp/" . $_GET['temp_file']);
```

**Security Impact:**  
Arbitrary command injection if `$temp_file` is not sanitized.

---

**3.4 `passthru()` usage**

```regex
passthru\s*\(\s*["'][^"']*["']\s*\.\s*\$
```

**Explanation:**  
`passthru` runs a command and streams the output directly. Same risk as `system`.

**Example:**

```php
passthru("ping -c 4 " . $_POST['host']);
```

**Security Impact:**  
Remote code execution if user can inject additional command sequences.

---

**3.5 Backtick operator in PHP**

```regex
`[^`]*\$[A-Za-z0-9_]+[^`]*`
```

**Explanation:**  
Flags backtick execution (e.g., ``$output = `ls $dir`;``) with a variable.

**Example:**

```php
$dir = $_GET['dir'];
$output = `ls -la $dir`;
```

**Security Impact:**  
Equivalent to shell_exec in functionality, prone to injection.

---

**3.6 `proc_open()` usage with dynamic parameters**

```regex
proc_open\s*\(\s*["'][^"']*["']\s*\.\s*\$
```

**Explanation:**  
`proc_open()` can also start processes. Detects concatenation usage.

**Example:**

```php
$process = proc_open("grep " . $_POST['search'], $descriptorspec, $pipes);
```

**Security Impact:**  
Attackers can inject arbitrary commands if not sanitized.

---

**3.7 `popen()` with dynamic commands**

```regex
popen\s*\(\s*["'][^"']*["']\s*\.\s*\$
```

**Explanation:**  
Similar to `proc_open`, flags `popen("somecmd" . $var)` usage.

**Example:**

```php
$pipe = popen("sort " . $_GET['file'], "r");
```

**Security Impact:**  
Allows reading/writing from a command; subject to injection.

---

**3.8 `exec("sudo ...")` specifically**

```regex
exec\s*\(\s*["']\s*sudo\s+[^"']*["']
```

**Explanation:**  
Targets calls that start with `sudo`, which can be especially dangerous if combined with user input.

**Example:**

```php
exec("sudo useradd " . $_POST['username']);
```

**Security Impact:**  
Running privileged commands with user input is a severe vulnerability.

---

**3.9 Data from `$_GET`/`$_POST` directly into command**

```regex
(exec|shell_exec|system|passthru)\s*\(\s*\$_(GET|POST|REQUEST)\[
```

**Explanation:**  
Straight usage of `$_GET[...]` or `$_POST[...]` as the command parameter. Extremely dangerous.

**Example:**

```php
system($_GET['cmd']);
```

**Security Impact:**  
Full remote code execution if no checks are in place.

---

**3.10 Indirect command injection via variable variables**

```regex
(exec|shell_exec|system|passthru)\s*\(\s*\$\{\$[A-Za-z0-9_]+\}
```

**Explanation:**  
Flags “variable variables” (e.g., `${$var}`) in command functions, which can hide injection points.

**Example:**

```php
$cmdVar = 'cmd';
$$cmdVar = 'ls -la /';
system($$cmdVar);
```

**Security Impact:**  
Obfuscated code can lead to injection if `$cmdVar` is manipulated externally.

---

# 4. Insecure Cryptographic Practices

PHP offers hashing and encryption functions, but older or weak approaches (e.g., `md5()`, `sha1()`) or hardcoded encryption keys are dangerous.

---

**4.1 Usage of `md5()` or `sha1()`**

```regex
\b(md5|sha1)\s*\(
```

**Explanation:**  
Detects calls to these weak hash functions.

**Example:**

```php
$hash = md5($password);
```

**Security Impact:**  
MD5 and SHA1 are no longer collision‐resistant and should not be used for security purposes.

---

**4.2 `openssl_encrypt()` with ECB mode**

```regex
openssl_encrypt\s*\(.*,\s*['"]AES-.*-ECB['"]
```

**Explanation:**  
Flags encryption with AES in ECB mode, which is insecure (lack of IV, pattern leakage).

**Example:**

```php
$encrypted = openssl_encrypt($data, 'AES-128-ECB', $key);
```

**Security Impact:**  
ECB mode can leak data patterns, weakening encryption.

---

**4.3 Hardcoded encryption keys in code**

```regex
\$[A-Za-z0-9_]*key\s*=\s*['"][A-Za-z0-9\/\+]{16,}['"]
```

**Explanation:**  
Looks for `$somethingKey = 'base64ishString'` or similarly long strings. Adjust length to your scenario.

**Example:**

```php
$encryptionKey = 'AbCdEfGhIjKlMnOpQrStUvWx';
```

**Security Impact:**  
Leaked keys allow offline decryption or tampering with data.

---

**4.4 `mcrypt` usage (deprecated)**

```regex
mcrypt_(encrypt|decrypt)\s*\(
```

**Explanation:**  
`mcrypt` is deprecated but may still appear in legacy code.

**Example:**

```php
$encrypted = mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $key, $plaintext, MCRYPT_MODE_CBC, $iv);
```

**Security Impact:**  
Legacy library, no longer considered secure or maintained.

---

**4.5 `base64_encode()` on sensitive data (hardcoded)**

```regex
base64_encode\s*\(\s*['"][^'"]+['"]\s*\)
```

**Explanation:**  
Encodes a hardcoded string in base64, possibly a hidden or embedded secret.

**Example:**

```php
$secretEncoded = base64_encode("MySecretKey123");
```

**Security Impact:**  
Base64 is not encryption; it’s easily reversed.

---

**4.6 `$iv =` with fixed initialization vectors**

```regex
\$iv\s*=\s*['"][A-Za-z0-9+/=]{8,}['"]
```

**Explanation:**  
Detects hardcoded IV variables, typically base64 or hex strings.

**Example:**

```php
$iv = "abcd1234efgh5678";
```

**Security Impact:**  
A static IV compromises cryptographic best practices.

---

**4.7 `hash('md5'` or `hash('sha1'` usage**

```regex
hash\s*\(\s*['"](md5|sha1)['"]
```

**Explanation:**  
Using the generic `hash()` function with MD5 or SHA1 is still weak.

**Example:**

```php
$checksum = hash('md5', $fileContents);
```

**Security Impact:**  
Attackers can potentially produce collisions.

---

**4.8 `password_hash()` with outdated algos**

```regex
password_hash\s*\(\s*\$[A-Za-z0-9_]+,\s*['"](\w+)['"]
```

**Explanation:**  
Flags usage of `password_hash($pass, 'someAlgo')` if the algo is not `PASSWORD_BCRYPT`, `PASSWORD_ARGON2I`, or `PASSWORD_ARGON2ID`. (Adjust to your standards.)

**Example:**

```php
$passwordHash = password_hash($plaintext, 'md5');
```

**Security Impact:**  
Using insecure custom hashing undermines password security.

---

**4.9 `openssl_encrypt()` or `_decrypt()` with a known weak cipher**

```regex
openssl_(encrypt|decrypt)\s*\([^,]+,\s*['"](DES|RC2|RC4)['"]
```

**Explanation:**  
Catches usage of DES, RC2, or RC4 ciphers.

**Example:**

```php
$data = openssl_encrypt($plain, 'DES-ECB', $key);
```

**Security Impact:**  
Legacy ciphers are considered broken or severely weakened.

---

**4.10 Hardcoded salt in password hashing**

```regex
\bsalt\s*=\s*['"][^'"]+['"]
```

**Explanation:**  
Look for literal “salt = 'someFixedValue'” in code, typical in manual hashing.

**Example:**

```php
$salt = "fixed_salt_value";
$hash = md5($salt . $password);
```

**Security Impact:**  
Reused salts across all passwords enable easier cracking.

---

# 5. Hardcoded Sensitive Endpoints / URLs

Leaking internal API endpoints, IP addresses, or domain names in PHP code can reveal infrastructure details.

---

**5.1 `http://` or `https://` in PHP strings**

```regex
['"]https?:\/\/[^'"]+['"]
```

**Explanation:**  
Matches any string literal starting with `http://` or `https://`.

**Example:**

```php
$endpoint = "https://internal.api.example.com/v1/getData";
```

**Security Impact:**  
Attackers can identify potential attack surfaces or internal endpoints.

---

**5.2 `ftp://` usage**

```regex
['"]ftp:\/\/[^'"]+['"]
```

**Explanation:**  
Flags hardcoded FTP addresses.

**Example:**

```php
$ftpHost = "ftp://192.168.100.20/files";
```

**Security Impact:**  
FTP is often unencrypted; an exposed endpoint can be attacked.

---

**5.3 `$apiUrl` or `$baseUrl` with domain/IP**

```regex
\$(apiUrl|baseUrl|endpoint)\s*=\s*['"]https?:\/\/[^'"]+['"]
```

**Explanation:**  
Common variable names containing endpoints.

**Example:**

```php
$apiUrl = "http://internal.service.local/api";
```

**Security Impact:**  
Reveals sensitive internal services.

---

**5.4 Localhost/127.0.0.1 references with ports**

```regex
['"](localhost|127\.0\.0\.1):\d{2,5}['"]
```

**Explanation:**  
Catches local development references (e.g., `'http://127.0.0.1:8080'`).

**Example:**

```php
$devServer = "http://localhost:8000";
```

**Security Impact:**  
Might indicate debugging or dev endpoints that are not secured.

---

**5.5 Private IP addresses (192.168.x.x or 10.x.x.x)**

```regex
['"](192\.168\.\d{1,3}\.\d{1,3}|10\.\d{1,3}\.\d{1,3}\.\d{1,3})['"]
```

**Explanation:**  
Matches typical private IP addresses hardcoded in strings.

**Example:**

```php
$internalHost = "192.168.1.15";
```

**Security Impact:**  
Leaking private IPs can help attackers map your network.

---

**5.6 `curl_init()` with a hardcoded URL**

```regex
curl_init\s*\(\s*['"]https?:\/\/[^'"]+['"]\s*\)
```

**Explanation:**  
Flags direct `curl_init("http://...")`.

**Example:**

```php
$ch = curl_init("https://api.example.com/data");
```

**Security Impact:**  
Reveals the remote endpoint for integration; potential pivot point.

---

**5.7 Guzzle or other HTTP client with fixed base URI**

```regex
new\s+Client\s*\(\s*\[\s*['"]base_uri['"]\s*=>\s*['"]https?:\/\/[^'"]+['"]\s*\]\s*\)
```

**Explanation:**  
For library clients (like Guzzle) specifying base_uri in constructor.

**Example:**

```php
$client = new Client(['base_uri' => 'http://internal.company.net/api']);
```

**Security Impact:**  
Shows internal API endpoints.

---

**5.8 `file_get_contents("http://...")`**

```regex
file_get_contents\s*\(\s*["']https?:\/\/[^"']+["']\s*\)
```

**Explanation:**  
If you fetch remote resources with a hardcoded URL.

**Example:**

```php
$data = file_get_contents("http://172.16.0.5/secretEndpoint");
```

**Security Impact:**  
Potential internal resource references that shouldn’t be public.

---

**5.9 Hardcoded domain in constants**

```regex
define\s*\(\s*['"][A-Za-z0-9_]*_URL['"]\s*,\s*['"]https?:\/\/[^'"]+['"]\s*\)
```

**Explanation:**  
Searches for `define('API_URL', 'http://myinternalapi')`.

**Example:**

```php
define('API_URL', 'https://corp-internal.example.org/v2');
```

**Security Impact:**  
Exposes server or service addresses.

---

**5.10 `$host =` or `$domain =` style assignments**

```regex
\$(host|domain)\s*=\s*['"][^'"]+\.[^'"]+['"]
```

**Explanation:**  
Generic pattern for code storing domain names in `$host` or `$domain`.

**Example:**

```php
$host = "db.internal.company.local";
```

**Security Impact:**  
Discloses internal DNS or domain naming conventions.

---

# 6. Insecure Error Handling and Logging

Excessive or detailed error logging (including stack traces, debug prints) can leak sensitive info about your PHP application’s internals.

---

**6.1 `error_log(print_r(...))` or `var_export(..., true)`**

```regex
error_log\s*\(\s*(print_r|var_export)\(
```

**Explanation:**  
Logs a detailed print of data structures, which can include secrets.

**Example:**

```php
error_log(print_r($_POST, true));
```

**Security Impact:**  
Sensitive user input or system data might get stored in logs.

---

**6.2 `var_dump()` or `print_r()` in production code**

```regex
(var_dump|print_r)\s*\(\s*\$[^\)]+\);
```

**Explanation:**  
Flags direct debug dumping of variables. (You can refine for dev vs. prod checks.)

**Example:**

```php
var_dump($internalData);
```

**Security Impact:**  
Reveals internal structure or sensitive data in logs/output.

---

**6.3 Logging `$exception->getTraceAsString()`**

```regex
->getTraceAsString\s*\(\s*\)
```

**Explanation:**  
Finding calls that log or echo full stack traces.

**Example:**

```php
catch (Exception $e) {
    error_log($e->getTraceAsString());
}
```

**Security Impact:**  
Stack traces can expose file paths, function names, and other details.

---

**6.4 `trigger_error(..., E_USER_WARNING/E_USER_NOTICE)` with sensitive info**

```regex
trigger_error\s*\(\s*['"][^'"]*(password|secret|token|apikey)[^'"]*['"].*,\s*(E_USER_WARNING|E_USER_NOTICE)
```

**Explanation:**  
Flags user‐triggered PHP errors that might contain credentials.

**Example:**

```php
trigger_error("Password is $dbPass", E_USER_WARNING);
```

**Security Impact:**  
Might leak secrets into system logs or error messages.

---

**6.5 Using `ini_set('display_errors', 'On')` in production**

```regex
ini_set\s*\(\s*['"]display_errors['"]\s*,\s*['"]On['"]\s*\)
```

**Explanation:**  
Shows that errors (with full stack traces in some setups) are displayed publicly.

**Example:**

```php
ini_set('display_errors', 'On'); // Should be off in production
```

**Security Impact:**  
Attackers can see sensitive debugging info directly in the browser.

---

**6.6 `@error_log()` of exception message**

```regex
error_log\\s*\\(\\s*\\$[A-Za-z0-9_]+\\->getMessage\\s*\\(\\s*\\)\\s*\\)
```

**Explanation:**  
Logs the raw exception message. Possibly not sanitized or might reveal internal data.

**Example:**

```php
error_log($e->getMessage());
```

**Security Impact:**  
Exception messages can contain DB errors or other sensitive details.

---

**6.7 `phpinfo()` calls**

```regex
phpinfo\s*\(\s*\)
```

**Explanation:**  
`phpinfo()` reveals extensive server and environment details if publicly accessible.

**Example:**

```php
if (isset($_GET['debug'])) {
    phpinfo();
}
```

**Security Impact:**  
Massive info leak about system paths, installed modules, etc.

---

**6.8 Hardcoded debug or logging flags**

```regex
\$debug\s*=\s*(true|1);|\$enableLogging\s*=\s*(true|1);
```

**Explanation:**  
Locates direct `$debug = true;` usage. Attackers might exploit verbose logs.

**Example:**

```php
$debug = true; // for local testing
```

**Security Impact:**  
Debug mode often expands logs to include sensitive data.

---

**6.9 Writing errors to a world‐readable log file**

```regex
error_log\s*\(\s*\$[^\)]+\s*,\s*3\s*,\s*['"]\/tmp\/[^'"]+['"]\)
```

**Explanation:**  
`error_log($message, 3, "/tmp/debug.log")` might be world‐readable on shared hosts.

**Example:**

```php
error_log($e->getTraceAsString(), 3, "/tmp/php_error.log");
```

**Security Impact:**  
Other users on the same system might read these logs.

---

**6.10 Echoing `$exception` or `$error` directly**

```regex
echo\s*\$[A-Za-z0-9_]+;\s*\/\/.*exception
```

**Explanation:**  
Tries to catch lines where an exception variable is echoed out.

**Example:**

```php
// echo $e; // Debugging only
```

**Security Impact:**  
Dumping exceptions can show code paths, queries, or environment info.

---

# 7. Insecure File I/O Operations and Path Traversal

User‐controlled file paths in PHP can cause unauthorized file reads or writes. Look for these typical patterns.

---

**7.1 `fopen()` with `$_GET` / `$_POST`**

```regex
fopen\s*\(\s*\$_(GET|POST|REQUEST)\[
```

**Explanation:**  
Directly using user input for `fopen()` is a classic path traversal or LFI vector.

**Example:**

```php
fopen($_GET['filename'], 'r');
```

**Security Impact:**  
Attackers can read arbitrary files or cause unexpected file writes.

---

**7.2 `include` / `require` with variables**

```regex
(include|require|include_once|require_once)\s*\(\s*\$[A-Za-z0-9_]+\s*\)
```

**Explanation:**  
Any variable used in an `include`/`require` call can be a Remote File Inclusion (RFI) or Local File Inclusion (LFI) risk.

**Example:**

```php
include($templateName);
```

**Security Impact:**  
Malicious users can include arbitrary files or remote URLs if not restricted.

---

**7.3 `file_get_contents()` with user input**

```regex
file_get_contents\s*\(\s*\$_(GET|POST|REQUEST)\[
```

**Explanation:**  
Could allow reading arbitrary files from the system or remote URLs if `allow_url_fopen` is enabled.

**Example:**

```php
$content = file_get_contents($_GET['path']);
```

**Security Impact:**  
Potential LFI or SSRF scenario.

---

**7.4 `unlink()` with variable path**

```regex
unlink\s*\(\s*\$[A-Za-z0-9_]+\s*\)
```

**Explanation:**  
Allows deletion of arbitrary files if user input is used directly.

**Example:**

```php
unlink($_REQUEST['file_to_delete']);
```

**Security Impact:**  
Attackers could remove critical system files if not locked down.

---

**7.5 `move_uploaded_file()` with unvalidated path**

```regex
move_uploaded_file\s*\(\s*\$[A-Za-z0-9_]+,\s*\$_(GET|POST|REQUEST)
```

**Explanation:**  
Attacker might choose the destination path, leading to overwriting key files or placing malicious scripts.

**Example:**

```php
move_uploaded_file($_FILES['up']['tmp_name'], $_POST['destination']);
```

**Security Impact:**  
Remote code execution by uploading a `.php` to a web‐accessible directory.

---

**7.6 `opendir()` or `scandir()` with user input**

```regex
(opendir|scandir)\s*\(\s*\$_(GET|POST|REQUEST)\[
```

**Explanation:**  
Enumerating directories based on user‐provided input.

**Example:**

```php
$files = scandir($_GET['dir']);
```

**Security Impact:**  
Attackers can list sensitive directories or escape from intended paths.

---

**7.7 Use of `realpath()` or `basename()` incorrectly**

```regex
(realpath|basename)\s*\(\s*\$_(GET|POST|REQUEST)
```

**Explanation:**  
Even if partially sanitized, usage might be incomplete, still allowing traversal if not verified.

**Example:**

```php
$file = realpath($_GET['file']);
fopen($file, 'r');
```

**Security Impact:**  
If checks are missing or insufficient, path traversal can still occur.

---

**7.8 `is_readable()` or `is_writable()` with user input**

```regex
(is_readable|is_writable)\s*\(\s*\$_(GET|POST|REQUEST)
```

**Explanation:**  
Attackers can probe the filesystem if this check is used with unvalidated input.

**Example:**

```php
if (is_readable($_POST['checkFile'])) {
    echo "File is readable!";
}
```

**Security Impact:**  
Information disclosure of which files exist and are accessible.

---

**7.9 Writing user data to arbitrary paths**

```regex
file_put_contents\s*\(\s*\$_(GET|POST|REQUEST)\[
```

**Explanation:**  
Lets users pick a path to write arbitrary content.

**Example:**

```php
file_put_contents($_POST['path'], $_POST['data']);
```

**Security Impact:**  
Enables overwriting arbitrary files or creating new malicious scripts.

---

**7.10 Serialized file usage**

```regex
file_put_contents\s*\(\s*['"][^'"]+\.ser['"]\s*,\s*serialize\s*\(
```

**Explanation:**  
Hints you’re storing serialized data in a `.ser` file. Could be combined with untrusted deserialization (see section 10).

**Example:**

```php
file_put_contents('session_data.ser', serialize($sessionArray));
```

**Security Impact:**  
Exposes possible read/modify attacks on the serialized file.

---

# 8. Unsafe Reflection and Dynamic Code Execution

PHP “reflection” is less common compared to some languages, but dynamic code execution is possible with `eval()`, `create_function()`, etc.

---

**8.1 `eval()` usage**

```regex
eval\s*\(\s*\$[A-Za-z0-9_]+\s*\)
```

**Explanation:**  
Executes PHP code in a variable. If user‐controlled, it’s a direct RCE vulnerability.

**Example:**

```php
eval($code);
```

**Security Impact:**  
Attackers can run arbitrary PHP code if `$code` is from external input.

---

**8.2 `eval($_GET` / `$_POST` / `$_REQUEST`) directly**

```regex
eval\s*\(\s*\$_(GET|POST|REQUEST)\[
```

**Explanation:**  
Immediately dangerous: raw user input is being evaluated as code.

**Example:**

```php
eval($_GET['cmd']);
```

**Security Impact:**  
Instant remote code execution if an attacker can craft `cmd`.

---

**8.3 `create_function()` usage**

```regex
create_function\s*\(
```

**Explanation:**  
Dynamically creates a function from a string of code. Deprecated in newer PHP versions.

**Example:**

```php
$lambda = create_function('$a,$b', 'return $a + $b;');
```

**Security Impact:**  
If `$code` is from user input, you get RCE.

---

**8.4 `assert()` used with untrusted data**

```regex
assert\s*\(\s*\$[A-Za-z0-9_]+\s*\)
```

**Explanation:**  
`assert()` in older PHP versions can interpret the string as PHP code if it’s not a boolean expression.

**Example:**

```php
assert($_POST['expression']);
```

**Security Impact:**  
Basically an `eval()`, but disguised as an assertion.

---

**8.5 Reflection classes invoked with dynamic strings**

```regex
new\s+Reflection(Class|Method|Function|Property)\s*\(\s*\$[A-Za-z0-9_]+\)
```

**Explanation:**  
Reflection usage with user input may allow inspection or invocation of private classes.

**Example:**

```php
$refClass = new ReflectionClass($_GET['className']);
```

**Security Impact:**  
Attackers might reflect on internal classes or call private methods.

---

**8.6 `call_user_func()` with user‐controlled function name**

```regex
call_user_func\s*\(\s*\$[A-Za-z0-9_]+
```

**Explanation:**  
If `$functionName` is from user input, they can call any function in the code.

**Example:**

```php
call_user_func($_GET['fn'], $arg1, $arg2);
```

**Security Impact:**  
May call arbitrary internal or PHP functions, leading to code or command execution.

---

**8.7 `call_user_func_array()` similarly**

```regex
call_user_func_array\s*\(\s*\$[A-Za-z0-9_]+
```

**Explanation:**  
Same risk but with an array of parameters.

**Example:**

```php
call_user_func_array($_POST['callFunc'], $params);
```

**Security Impact:**  
Potential invocation of powerful functions (e.g., `system`, `exec`, etc.).

---

**8.8 `ReflectionMethod->invoke()` or `invokeArgs()` with dynamic method**

```regex
->invoke(Args)?\s*\(\s*\$[A-Za-z0-9_]+\s*,?
```

**Explanation:**  
A reflection method call invoked with user data.

**Example:**

```php
$method = $refClass->getMethod($_GET['methodName']);
$method->invoke($obj);
```

**Security Impact:**  
Attackers might call restricted methods.

---

**8.9 `preg_replace('/e'...)` modifier in older PHP versions**

```regex
preg_replace\s*\(\s*['"].*e['"],\s*
```

**Explanation:**  
`/e` modifier executes PHP code in the replacement string (deprecated in newer PHP).

**Example:**

```php
$str = preg_replace("/(.*)/e", "strtoupper('$1')", $input);
```

**Security Impact:**  
Attacker‐controlled patterns can lead to code execution.

---

**8.10 `runkit_function_add()` or `runkit_function_redefine()`**

```regex
runkit_function_(add|redefine)\s*\(
```

**Explanation:**  
`runkit` is a powerful extension allowing dynamic modification of functions.

**Example:**

```php
runkit_function_redefine('foo', '$x', 'echo $x;');
```

**Security Impact:**  
If user input is used, it can drastically alter code flow or inject malicious functions.

---

# 9. Hardcoded Application Configuration Values

Many PHP projects keep environment, mode, or config details in code instead of environment variables or separate config files.

---

**9.1 `$env = 'production'`**

```regex
\$env\s*=\s*['"](production|staging|development)['"]
```

**Explanation:**  
Flags direct environment strings. Adjust to match your typical environment naming.

**Example:**

```php
$env = 'production';
```

**Security Impact:**  
Hardcoding can lead to confusion or leaking environment details.

---

**9.2 `$config` arrays with `environment` or `mode` keys**

```regex
(\$config|\$settings)\s*=\s*\[[^\]]*(environment|mode)\s*=>\s*['"][^'"]+['"][^\]]*\]
```

**Explanation:**  
Look for config arrays that specify `'environment' => '...'`.

**Example:**

```php
$config = [
  'environment' => 'dev',
  'debug' => true
];
```

**Security Impact:**  
Attackers learn about system environment or debug settings.

---

**9.3 `define('APP_ENV', 'production')`**

```regex
define\s*\(\s*['"]APP_ENV['"]\s*,\s*['"](production|development|staging)['"]\s*\)
```

**Explanation:**  
Common pattern for a globally defined environment constant.

**Example:**

```php
define('APP_ENV', 'staging');
```

**Security Impact:**  
Exposes environment config if code is leaked.

---

**9.4 `.env` style with environment name**

```regex
^APP_ENV\s*=\s*(?i)(development|staging|production)
```

**Explanation:**  
Looks for environment flags in a `.env` file.

**Example:**

```
APP_ENV=production
```

**Security Impact:**  
If the `.env` is leaked, an attacker knows exactly which environment is running.

---

**9.5 Hardcoded debug toggles in config arrays**

```regex
['"]debug['"]\s*=>\s*(true|1)
```

**Explanation:**  
Enables debug mode in a config array.

**Example:**

```php
return [
  'debug' => true
];
```

**Security Impact:**  
Debug mode can reveal stack traces and queries.

---

**9.6 `$mode = '...'` style assignment**

```regex
\$mode\s*=\s*['"]\w+['"]
```

**Explanation:**  
Generic pattern for `$mode = 'dev'` or `$mode = 'maintenance'`.

**Example:**

```php
$mode = 'maintenance';
```

**Security Impact:**  
Leaking maintenance mode might lead to targeted attacks.

---

**9.7 Comments indicating environment or config**

```regex
\/\/.*(Environment|Config|Mode):\s*\w+
```

**Explanation:**  
Look for developer comments that reveal environment or config details.

**Example:**

```php
// Environment: Staging
```

**Security Impact:**  
Attackers gain more system context.

---

**9.8 `$settings['env'] = '...'`**

```regex
\$settings\['env'\]\s*=\s*['"]\w+['"]
```

**Explanation:**  
Another common array assignment for environment.

**Example:**

```php
$settings['env'] = 'local';
```

**Security Impact:**  
Exposes environment or operational mode.

---

**9.9 `putenv("ENV=...")` calls**

```regex
putenv\s*\(\s*['"]ENV=.*['"]\)
```

**Explanation:**  
May set environment variables from within PHP code.

**Example:**

```php
putenv("ENV=debug");
```

**Security Impact:**  
Hardcoding environment within code can be a sign of misconfiguration.

---

**9.10 `$GLOBALS['CONFIG']` references**

```regex
\$GLOBALS\['CONFIG'\]\s*\[\s*['"](env|mode|debug)['"]\s*\]\s*=\s*['"][^'"]+['"]
```

**Explanation:**  
Detects environment or mode settings in `$GLOBALS['CONFIG']`.

**Example:**

```php
$GLOBALS['CONFIG']['env'] = 'production';
```

**Security Impact:**  
If `$GLOBALS` is dumped, these details are exposed.

---

# 10. Insecure Deserialization

PHP’s `unserialize()` is notorious for security issues if used on untrusted data. Attackers can craft payloads that invoke unexpected object destructors or methods.

---

**10.1 Direct `unserialize($_POST` or `$_GET`)**

```regex
unserialize\s*\(\s*\$_(GET|POST|REQUEST)\[
```

**Explanation:**  
Immediately insecure, user input is directly unserialized.

**Example:**

```php
$data = unserialize($_POST['payload']);
```

**Security Impact:**  
Remote code execution or object injection.

---

**10.2 `unserialize()` of `$cookie` data**

```regex
unserialize\s*\(\s*\$_COOKIE
```

**Explanation:**  
Cookies can also be tampered with, leading to malicious objects.

**Example:**

```php
$userData = unserialize($_COOKIE['sessionData']);
```

**Security Impact:**  
Attackers can pass a manipulated cookie to exploit object injection.

---

**10.3 `unserialize(base64_decode(...))`**

```regex
unserialize\s*\(\s*base64_decode\s*\(\s*\$_(GET|POST|COOKIE|REQUEST)
```

**Explanation:**  
A common pattern: data is base64‐decoded then unserialized. Still untrusted if from user.

**Example:**

```php
$payload = unserialize(base64_decode($_REQUEST['data']));
```

**Security Impact:**  
Obfuscation doesn’t protect from malicious payloads.

---

**10.4 `unserialize()` on files or DB data directly**

```regex
unserialize\s*\(\s*file_get_contents\s*\(
```

**Explanation:**  
If the file contents themselves are from external or user‐controlled sources.

**Example:**

```php
$data = unserialize(file_get_contents('/path/to/store/' . $_GET['file']));
```

**Security Impact:**  
Attacker can upload a crafted file to trigger object injection.

---

**10.5 `unserialize()` in older custom session handling**

```regex
session_set_save_handler\([^)]*\).*unserialize
```

**Explanation:**  
Sometimes custom session handlers do unserialize behind the scenes.

**Example:**

```php
session_set_save_handler(new CustomSessionHandler());
```

(Inside `CustomSessionHandler`, you might find `unserialize`.)

**Security Impact:**  
If session data is manipulated, it can lead to RCE.

---

**10.6 `__wakeup()` or `__destruct()` inside classes**

```regex
class\s+[A-Za-z0-9_]+\s*{[^}]*function\s+(__wakeup|__destruct)\s*\(
```

**Explanation:**  
Flags classes with special methods that might be invoked upon unserialize. Not always a vulnerability by itself, but it’s a sign that object injection could be abused.

**Example:**

```php
class Exploitable {
    public function __destruct() {
        // runs upon object destruction
        system($this->cmd);
    }
}
```

**Security Impact:**  
An attacker can create a serialized object that sets `$this->cmd` to malicious commands.

---

**10.7 `serialize()` usage (to check for potential matching `unserialize()`)**

```regex
serialize\s*\(\s*\$[A-Za-z0-9_]+\s*\)
```

**Explanation:**  
If you see data being serialized, check how it’s later unserialized or validated.

**Example:**

```php
$serialized = serialize($userData);
```

**Security Impact:**  
Application might be storing user data for later unserialization.

---

**10.8 Custom unserializer function calls**

```regex
function\s+\w+\s*\([^)]*\)\s*{[^}]*unserialize\s*\(
```

**Explanation:**  
Find custom functions that call `unserialize()`. They may handle untrusted data.

**Example:**

```php
function loadData($input) {
  return unserialize($input);
}
```

**Security Impact:**  
Evaluate how `$input` is obtained.

---

**10.9 `unserialize()` with `__PHP_Incomplete_Class` warnings**

```regex
__PHP_Incomplete_Class
```

**Explanation:**  
Not a direct pattern for code, but searching for references can find partial or suspicious serialization usage.

**Example:**  
N/A – This is more of a sign you have incomplete class definitions from `unserialize`.

**Security Impact:**  
Might indicate missing class definitions or legacy unserialized data.

---

**10.10 Deserialization in frameworks (e.g., Laravel’s `unserialize()`)**

```regex
unserialize\s*\(\s*\$request->input\s*\(
```

**Explanation:**  
Specifically flags usage if a framework’s request object is used for input. Adjust to your framework.

**Example:**

```php
$data = unserialize($request->input('payload'));
```

**Security Impact:**  
Same risk: malicious serialized objects can trigger harmful code paths.

---

# 11. Insecure Use of Regular Expressions (ReDoS)

Certain PHP `preg_*` patterns can degrade performance drastically with crafted input, creating a Regular Expression Denial of Service (ReDoS).

---

**11.1 `preg_match` with nested quantifiers**

```regex
preg_match\s*\(\s*['"].*(\(.*\)\+){2,}.*['"]
```

**Explanation:**  
Captures patterns with something like `(a+)+` or nested quantifiers typical of catastrophic backtracking.

**Example:**

```php
preg_match("/(a+)+$/", $input);
```

**Security Impact:**  
Attacker can create input strings that cause exponential backtracking.

---

**11.2 `preg_replace` with user input in the pattern**

```regex
preg_replace\s*\(\s*\$_(GET|POST|REQUEST)\[
```

**Explanation:**  
If the user is controlling the **pattern** itself. Extremely dangerous – can lead to ReDoS or code injection if `/e` is used (older PHP).

**Example:**

```php
$result = preg_replace($_GET['pattern'], '', $data);
```

**Security Impact:**  
Attacker can supply pathological regex or even exploit old `/e` modifier.

---

**11.3 `preg_match_all` with suspicious repetition patterns**

```regex
preg_match_all\s*\(\s*['"].*(\.\*){2,}['"]
```

**Explanation:**  
Flags repeated `.*.*` sequences which can be prime candidates for catastrophic backtracking.

**Example:**

```php
preg_match_all("/^.*.*abc$/", $string, $matches);
```

**Security Impact:**  
A carefully crafted input can cause the regex engine to hang.

---

**11.4 Very large repetition ranges**

```regex
\{[0-9]{3,},[0-9]*\}
```

**Explanation:**  
Detects something like `{100,}` which might be excessive and lead to performance issues.

**Example:**

```php
preg_match("/a{100,}/", $text);
```

**Security Impact:**  
Large repetitions can degrade performance on big input strings.

---

**11.5 Combining `.*` with alternation in a single group**

```regex
\(\.\*\|.*\.\*\)
```

**Explanation:**  
A pattern like `(.*|.*)` can lead to large backtracking expansions.

**Example:**

```php
preg_match("/(abc.*|.*xyz)/", $input);
```

**Security Impact:**  
Attacker can create input that triggers catastrophic backtracking.

---

**11.6 Searching for `(.*)+` specifically**

```regex
\(\.\*\)\+
```

**Explanation:**  
Directly flags the literal `(.*)+` usage.

**Example:**

```php
if (preg_match("/(.*)+world$/", $value)) {
    // ...
}
```

**Security Impact:**  
If `$value` is large, performance may degrade significantly.

---

**11.7 `preg_replace_callback` with complex patterns**

```regex
preg_replace_callback\s*\(\s*['"].*((\(.*\)\{)|(\(\.\*\)\+)).*['"]
```

**Explanation:**  
Regex-based callback replacements can also be exposed to ReDoS if pattern is vulnerable.

**Example:**

```php
preg_replace_callback("/(ab+)+c/", function($m) { ... }, $input);
```

**Security Impact:**  
Same catastrophic backtracking issue.

---

**11.8 `u` (UTF-8) modifier with ambiguous character classes**

```regex
['"]\/.*\[.*\].*\/u['"]
```

**Explanation:**  
UTF-8 can compound complexity if combined with poorly structured patterns.

**Example:**

```php
preg_match("/[\s\S]+/u", $input);
```

**Security Impact:**  
UTF-8 matching can be slower and more prone to catastrophic backtracking.

---

**11.9 Overly broad “dot” usage in `preg_split`**

```regex
preg_split\s*\(\s*['"]\/\.\*\/['"]
```

**Explanation:**  
Splitting on `.*` might be suspect. Adjust to your needs.

**Example:**

```php
$parts = preg_split("/.*/", $data);
```

**Security Impact:**  
Likely a logic error or can degrade performance with large input.

---

**11.10 `ereg`/`eregi` usage (deprecated)**

```regex
\bereg(i)?\s*\(
```

**Explanation:**  
Old PHP regex functions that are not PCRE. They’re deprecated, but you might find them in legacy code.

**Example:**

```php
if (eregi("^[a-z]+$", $input)) {
    ...
}
```

**Security Impact:**  
Besides being outdated, these can have performance issues and lack modern security features.

---

# 12. Insecure Inter-Process Communication (IPC)

While not as common in PHP as in other languages, PHP can still create sockets, connect to message queues, or spawn processes.

---

**12.1 `stream_socket_server()` usage**

```regex
stream_socket_server\s*\(\s*['"][^'"]+['"]
```

**Explanation:**  
Detects listening sockets created by PHP. If accessible externally, it might be insecure.

**Example:**

```php
$server = stream_socket_server("tcp://0.0.0.0:8000");
```

**Security Impact:**  
No authentication could let anyone connect.

---

**12.2 `stream_socket_client()` with external addresses**

```regex
stream_socket_client\s*\(\s*['"]tcp:\/\/[^'"]+['"]
```

**Explanation:**  
Outgoing connections that might leak info or be manipulated.

**Example:**

```php
$fp = stream_socket_client("tcp://192.168.1.50:9000");
```

**Security Impact:**  
Attacker might redirect or intercept if not secured with TLS or checks.

---

**12.3 `fsockopen()` usage**

```regex
fsockopen\s*\(\s*['"][^'"]+['"]
```

**Explanation:**  
Low‐level socket connections. If used for internal services, might reveal sensitive endpoints.

**Example:**

```php
$fp = fsockopen("localhost", 8080);
```

**Security Impact:**  
If data is unencrypted or unauthenticated, can be tampered with or observed.

---

**12.4 `pfsockopen()` (persistent socket) usage**

```regex
pfsockopen\s*\(\s*['"][^'"]+['"]
```

**Explanation:**  
Similar risk, persistent socket connections remain open across requests.

**Example:**

```php
$persistent = pfsockopen("10.0.0.5", 3306);
```

**Security Impact:**  
Potentially shares state with other requests, can be hijacked.

---

**12.5 Creating Unix domain sockets**

```regex
stream_socket_server\s*\(\s*['"]unix:\/\/
```

**Explanation:**  
Unix domain sockets might have insecure permissions if not carefully set.

**Example:**

```php
$server = stream_socket_server("unix:///tmp/php.sock");
```

**Security Impact:**  
Any local user could connect if permissions are lax.

---

**12.6 `socket_create()` usage**

```regex
socket_create\s*\(
```

**Explanation:**  
Explicitly working with raw sockets in PHP.

**Example:**

```php
$socket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);
```

**Security Impact:**  
If user input configures or binds the socket, it could be abused.

---

**12.7 `msg_get_queue()` usage**

```regex
msg_get_queue\s*\(
```

**Explanation:**  
Creates or attaches to a System V message queue in PHP. Could leak or intercept messages.

**Example:**

```php
$queue = msg_get_queue(1234);
```

**Security Impact:**  
Without proper permissions, attackers can read or send malicious messages.

---

**12.8 `socket_bind()` with user input**

```regex
socket_bind\s*\(\s*\$[A-Za-z0-9_]+\s*,\s*\$_(GET|POST|REQUEST)
```

**Explanation:**  
If the IP or port comes from user input, major security risk.

**Example:**

```php
socket_bind($sock, $_GET['ip'], $_GET['port']);
```

**Security Impact:**  
Attacker can hijack or cause the server to bind to restricted ports.

---

**12.9 RabbitMQ or other queue library calls**

```regex
new\s+AMQPConnection\s*\(\s*\[['"].*host['"].*=>.*['"]\)
```

**Explanation:**  
If you store queue credentials or host in code, it might be discovered.

**Example:**

```php
$conn = new AMQPConnection([
  'host' => '192.168.0.5',
  'port' => 5672,
  'login' => 'guest',
  'password' => 'guest'
]);
```

**Security Impact:**  
Hardcoded credentials to the message queue.

---

**12.10 Redis or Memcached connections with hardcoded servers**

```regex
(new\s+Redis|new\s+Memcached).*\(\s*\).*(addServer|connect)\s*\(\s*['"][^'"]+['"]
```

**Explanation:**  
Looks for direct usage of `$redis->connect("10.0.0.10")` or `$memcached->addServer("localhost", 11211)`.

**Example:**

```php
$redis->connect("10.10.0.5");
```

**Security Impact:**  
Could allow unauthorized caching or reading of sessions if an attacker can connect to the same service.

---

# 13. Additional Vulnerabilities and Security Misconfigurations

Catch‐all category for leftover debug code, commented credentials, or common insecure markers that slip through code reviews.

---

**13.1 Single‐line comment with `TODO|FIXME|HACK`**

```regex
\/\/\s*(TODO|FIXME|HACK)\b.*$
```

**Explanation:**  
Flags developer comments indicating incomplete or hacky code that might be insecure.

**Example:**

```php
// TODO: sanitize this input later
```

**Security Impact:**  
These can be a clue to incomplete security checks.

---

**13.2 Multi‐line comment references to passwords or tokens**

```regex
\/\*[^*]*(password|token|secret|apikey)[\s\S]*?\*\/
```

**Explanation:**  
Search block comments for mention of sensitive strings.

**Example:**

```php
/*
  This secret key "XYZ123" is used for local testing only
*/
```

**Security Impact:**  
Leaked in version control or to other devs inadvertently.

---

**13.3 Leftover debug statements (e.g., `die($var)`)**

```regex
die\s*\(\s*\$[A-Za-z0-9_]+\s*\)
```

**Explanation:**  
Developers often do `die($var)` or `exit($var)` for debugging, which may disclose data.

**Example:**

```php
die($dbPassword);
```

**Security Impact:**  
Accidental exposure of sensitive info.

---

**13.4 `ini_set('display_startup_errors', true)`**

```regex
ini_set\s*\(\s*['"]display_startup_errors['"]\s*,\s*['"]1['"]\s*\)
```

**Explanation:**  
Enables showing errors at startup, which can reveal environment data.

**Example:**

```php
ini_set('display_startup_errors', '1');
```

**Security Impact:**  
Leads to excessive debugging info on server issues.

---

**13.5 Commented‐out code blocks with actual functional code**

```regex
\/\/\s*if\s*\(\$[A-Za-z0-9_]+\).*\{.*$|\/\*.*\$[A-Za-z0-9_].*\*\//
```

**Explanation:**  
Large commented blocks of real code can hide vulnerabilities.

**Example:**

```php
/* 
if ($_GET['debug']) {
   eval($_GET['cmd']); // remove before production
}
*/
```

**Security Impact:**  
May be reactivated or missed in security reviews.

---

**13.6 `$GLOBALS` usage referencing anything suspicious**

```regex
\$GLOBALS\[['"][A-Za-z0-9_]+['"]\]\s*=\s*\$_(GET|POST|REQUEST)
```

**Explanation:**  
Combining superglobals into `$GLOBALS` can create unexpected usage or expansions.

**Example:**

```php
$GLOBALS['someVar'] = $_GET['param'];
```

**Security Impact:**  
Might be used later in code for critical operations.

---

**13.7 `echo` or `print` of raw `$_GET`/`$_POST`**

```regex
(echo|print)\s*\$_(GET|POST|REQUEST)\[
```

**Explanation:**  
Potential XSS if user input is echoed unescaped.

**Example:**

```php
echo $_GET['message'];
```

**Security Impact:**  
Reflective XSS or injection in HTML output.

---

**13.8 `header("Location: " . $_GET)`**

```regex
header\s*\(\s*["']Location:\s*["']\s*\.\s*\$_(GET|POST|REQUEST)\[
```

**Explanation:**  
Redirecting users with unsanitized input leads to open redirect vulnerabilities.

**Example:**

```php
header("Location: " . $_POST['next_url']);
```

**Security Impact:**  
Phishing or malicious redirection.

---

**13.9 Calls to `mail()` with user‐controlled parameters**

```regex
mail\s*\(\s*\$_(GET|POST|REQUEST)\[
```

**Explanation:**  
Attackers can exploit this to send spam or manipulate email headers (Email injection).

**Example:**

```php
mail($_POST['recipient'], "Hello", "Test");
```

**Security Impact:**  
Email header injection or spamming.

---

**13.10 `$php_errormsg` usage**

```regex
\$php_errormsg
```

**Explanation:**  
Legacy variable that might hold sensitive error messages if turned on.

**Example:**

```php
echo $php_errormsg;
```

**Security Impact:**  
Can reveal detailed internal errors to the user.